<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ù„Ù‡ Ø£ÙˆÙ„Ø§Ù‹</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Amiri:ital,wght@0,400;0,700;1,400&family=Reem+Kufi:wght@700&family=Aref+Ruqaa:wght@700&display=swap');

        :root {
            --bg: #fdfaf1; /* ÙƒØ±ÙŠÙ…ÙŠ */
            --text: #4a342e;
            --accent: #b38728; /* Ø°Ù‡Ø¨ÙŠ */
            --card: rgba(255, 255, 255, 0.9);
            --gold-gradient: linear-gradient(135deg, #bf953f, #fcf6ba, #b38728, #fcf6ba, #aa771c);
            --pattern: url('https://www.transparenttextures.com/patterns/arabesque.png');
            --shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .dark-mode {
            --bg: #2b1d0e; /* Ø¨Ù†ÙŠ ÙØ®Ù… */
            --text: #fcf6ba;
            --accent: #d4af37;
            --card: rgba(61, 43, 31, 0.9);
            --shadow: 0 10px 40px rgba(0,0,0,0.4);
        }

        .ramadan-mode {
            --bg: #050505; /* Ø£Ø³ÙˆØ¯ */
            --text: #f1d592;
            --accent: #ffcc33;
            --card: #121212;
            --pattern: url('https://www.transparenttextures.com/patterns/stardust.png');
        }

        body {
            font-family: 'Amiri', serif; background-color: var(--bg); color: var(--text);
            margin: 0; padding: 15px; transition: all 0.5s ease;
            background-image: var(--pattern); min-height: 100vh;
        }

        /* Ø§Ù„Ø´Ø¹Ø§Ø± Ø§Ù„ÙØ®Ù… */
        .header-container { text-align: center; margin: 40px 0 30px; }
        .main-logo {
            font-family: 'Reem Kufi', sans-serif;
            font-size: 5.5em;
            background: var(--gold-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            filter: drop-shadow(0 5px 15px rgba(179, 135, 40, 0.4));
            margin: 0;
            line-height: 1;
            letter-spacing: -2px;
        }
        .sub-logo {
            font-family: 'Reem Kufi', sans-serif;
            font-size: 2.2em;
            background: var(--gold-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-top: -15px;
        }
        .slogan {
            font-family: 'Amiri', serif;
            font-style: italic;
            font-size: 1.3em;
            margin-top: 15px;
            opacity: 0.8;
            color: var(--accent);
        }

        /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        .main-grid { display: grid; gap: 15px; margin-top: 20px; }
        .btn-main {
            background: var(--card);
            border: 1px solid rgba(179, 135, 40, 0.3);
            border-radius: 18px;
            padding: 20px;
            font-size: 1.2em;
            font-weight: bold;
            color: var(--text);
            box-shadow: var(--shadow);
            cursor: pointer;
            transition: 0.3s;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .btn-main:active { transform: scale(0.98); }
        .btn-main i { font-size: 1.4em; color: var(--accent); }

        /* Ø§Ù„Ø³Ø¨Ø­Ø© Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ© */
        .tasbih-container {
            width: 220px; height: 220px;
            border-radius: 50%;
            margin: 30px auto;
            border: 6px solid;
            border-image: var(--gold-gradient) 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: var(--card);
            box-shadow: 0 0 30px rgba(179, 135, 40, 0.2);
            position: relative;
            cursor: pointer;
            overflow: hidden;
        }
        .tasbih-count { font-size: 3.5em; font-weight: bold; background: var(--gold-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .tasbih-label { font-size: 0.8em; text-align: center; padding: 0 10px; }

        /* Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… */
        .admin-section {
            background: rgba(179, 135, 40, 0.1);
            border: 1px dashed var(--accent);
            padding: 20px; margin-top: 40px; border-radius: 20px;
            display: none;
        }
        .input-gold {
            width: 100%; padding: 12px; margin: 10px 0;
            background: var(--card); border: 1px solid var(--accent);
            border-radius: 10px; color: var(--text); box-sizing: border-box;
        }

        /* Ø§Ù„ÙÙˆØ§Ù†ÙŠØ³ ÙÙŠ ÙˆØ¶Ø¹ Ø±Ù…Ø¶Ø§Ù† */
        .fanoos-decor {
            display: none; position: fixed; top: 10px; width: 50px; opacity: 0.7;
        }
        .ramadan-mode .fanoos-decor { display: block; }

        /* Ø§Ù„Ø£Ù‚Ø³Ø§Ù… */
        .page { display: none; animation: fadeIn 0.6s ease; }
        .active-page { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .delete-btn { color: #ff4444; cursor: pointer; float: left; font-size: 1.2em; }
        
        /* Ø§Ù„Ø®Ù„ÙˆØ© */
        #khalwaOverlay {
            position: fixed; top:0; left:0; width:100%; height:100%;
            background: var(--bg); z-index: 9999; display:none;
            justify-content: center; align-items: center; text-align: center;
        }
    </style>
</head>
<body>

<img src="https://img.icons8.com/color/96/ramadan-lantern.png" class="fanoos-decor" style="right: 10px;">
<img src="https://img.icons8.com/color/96/ramadan-lantern.png" class="fanoos-decor" style="left: 10px;">

<div id="homePage" class="page active-page">
    <div class="header-container">
        <h1 class="main-logo">Ø§Ù„Ù„Ù‡</h1>
        <div class="sub-logo">Ø£ÙˆÙ„Ø§Ù‹</div>
        <div class="slogan">Ø³ÙŠØ±ÙˆØ§ Ø¥Ù„Ù‰ Ø§Ù„Ù„Ù‡ Ø¹Ø±Ø¬Ù‰ ÙˆÙ…ÙƒØ§Ø³ÙŠØ±..</div>
    </div>

    <div class="tasbih-container" onclick="incrementGlobalTasbih()">
        <div class="tasbih-label">ï´¿ ÙˆÙØªÙØ¹ÙØ§ÙˆÙÙ†ÙÙˆØ§ Ø¹ÙÙ„ÙÙ‰ Ø§Ù„Ù’Ø¨ÙØ±Ù‘Ù ï´¾</div>
        <div id="globalCount" class="tasbih-count">0</div>
        <button id="resetBtn" style="display:none; background:none; border:none; cursor:pointer; position:absolute; bottom:10px;" onclick="event.stopPropagation(); resetGlobal()">ğŸ”„</button>
    </div>

    <div class="main-grid">
        <div class="btn-main" onclick="openSection('namesPage')">ğŸ“– Ø±Ø­Ù„Ø© Ù…Ø¹Ø±ÙØ© Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ <span>â¬…ï¸</span></div>
        <div class="btn-main" onclick="startKhalwa()">ğŸ§˜â€â™‚ï¸ Ø§Ù„Ø®Ù„ÙˆØ© <span>â¬…ï¸</span></div>
        <div class="btn-main" onclick="openSection('munajatPage')">ğŸ¤² Ø§Ù„Ù…Ù†Ø§Ø¬Ø§Ø© <span>â¬…ï¸</span></div>
        <div class="btn-main" onclick="openSection('thoughtsPage')">âœ¨ Ø®ÙˆØ§Ø·Ø± Ø±Ø¨Ø§Ù†ÙŠØ© <span>â¬…ï¸</span></div>
        <div class="btn-main" onclick="openSection('moodPage')">â¤ï¸ ÙƒÙŠÙ Ø­Ø§Ù„ Ù‚Ù„Ø¨ÙƒØŸ <span>â¬…ï¸</span></div>
    </div>

    <button class="btn-main" style="margin: 30px auto; width: 60px; justify-content: center;" onclick="toggleVisualMode()">ğŸŒ“</button>

    <div id="adminPanel" class="admin-section">
        <h3 style="text-align:center">ğŸ›  Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… (Ù„Ù„Ù…Ø§Ù„ÙƒØ©)</h3>
        <select id="dataType" class="input-gold">
            <option value="names">Ø¥Ø¶Ø§ÙØ© Ø§Ø³Ù… Ø¬Ø¯ÙŠØ¯</option>
            <option value="thoughts">Ø¥Ø¶Ø§ÙØ© Ø®Ø§Ø·Ø±Ø©</option>
        </select>
        <input type="text" id="dataTitle" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù† (Ù…Ø«Ù„Ø§Ù‹: Ø§Ù„Ø±Ø­Ù…Ù†)" class="input-gold">
        <textarea id="dataContent" placeholder="Ø§Ù„Ù…Ø­ØªÙˆÙ‰ (Ø§Ø³ØªØ®Ø¯Ù… | Ù„Ù„ÙØµÙ„ Ø¨ÙŠÙ† Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø¹Ù…Ù„ÙŠØ©)" class="input-gold" rows="4"></textarea>
        <button class="btn-main" style="background: var(--gold-gradient); width: 100%; color: #000;" onclick="uploadData()">Ù†Ø´Ø± Ø§Ù„Ø¢Ù†</button>
    </div>
</div>

<div id="namesPage" class="page">
    <h2 class="sub-logo" style="text-align:center">Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø­Ø³Ù†Ù‰</h2>
    <div id="namesList" class="main-grid"></div>
    <button class="btn-main" style="margin-top:20px" onclick="goHome()">ğŸ  Ø§Ù„Ø¹ÙˆØ¯Ø©</button>
</div>

<div id="nameDetails" class="page">
    <h1 id="currentName" class="main-logo" style="text-align:center; font-size:4em;"></h1>
    <div id="currentContent" style="padding:20px; line-height:1.8; font-size:1.2em; text-align:justify;"></div>
    
    <div id="currentTasks" style="background:rgba(179,135,40,0.1); padding:15px; border-radius:15px; margin:15px 0;"></div>

    <div class="tasbih-container" onclick="localTasbih()" style="width:150px; height:150px;">
        <div id="localCount" class="tasbih-count" style="font-size:2.5em;">0</div>
        <div style="font-size:0.7em">ÙˆÙØ±Ø¯ Ø§Ù„Ø§Ø³Ù…</div>
    </div>

    <div id="userStories" style="margin-top:30px;">
        <h3>Ù…ÙˆØ§Ù‚ÙÙƒÙ… Ù…Ø¹ Ù‡Ø°Ø§ Ø§Ù„Ø§Ø³Ù…:</h3>
        <div id="storiesBox" style="max-height:200px; overflow-y:auto; margin-bottom:10px;"></div>
        <textarea id="newStory" class="input-gold" placeholder="Ø§ÙƒØªØ¨ Ù…ÙˆÙ‚ÙØ§Ù‹ Ø­Ø¯Ø« Ù„Ùƒ..."></textarea>
        <button class="btn-main" onclick="saveStory()">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…ÙˆÙ‚Ù</button>
    </div>
    <button class="btn-main" style="margin-top:20px" onclick="openSection('namesPage')">ğŸ”™ Ø±Ø¬ÙˆØ¹</button>
</div>

<div id="munajatPage" class="page">
    <h2 class="sub-logo" style="text-align:center">Ù†Ø§Ø¬Ù Ø§Ù„Ù„Ù‡..</h2>
    <p style="text-align:center; opacity:0.7">Ø±Ø³Ø§Ù„ØªÙƒ ØªØ°Ù‡Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù…Ø§Ø¡ ÙÙˆØ±Ø§Ù‹ ÙˆÙ„Ø§ ÙŠØ±Ø§Ù‡Ø§ Ø£Ø­Ø¯.</p>
    <textarea id="munajatText" class="input-gold" rows="10" placeholder="Ø§ÙƒØªØ¨ ÙƒÙ„ Ù…Ø§ ÙÙŠ Ù‚Ù„Ø¨Ùƒ Ù‡Ù†Ø§..."></textarea>
    <button class="btn-main" onclick="sendToHeaven()">Ø£Ø³ØªÙˆØ¯Ø¹ Ø§Ù„Ù„Ù‡ Ù‚Ù„Ø¨ÙŠ âœ¨</button>
    <button class="btn-main" style="margin-top:20px" onclick="goHome()">ğŸ  Ø§Ù„Ø¹ÙˆØ¯Ø©</button>
</div>

<div id="thoughtsPage" class="page">
    <h2 class="sub-logo" style="text-align:center">Ø±Ø³Ø§Ø¦Ù„ ÙˆØ®ÙˆØ§Ø·Ø±</h2>
    <div id="thoughtsList"></div>
    <button class="btn-main" style="margin-top:20px" onclick="goHome()">ğŸ  Ø§Ù„Ø¹ÙˆØ¯Ø©</button>
</div>

<div id="moodPage" class="page">
    <h2 class="sub-logo" style="text-align:center">ÙƒÙŠÙ Ø­Ø§Ù„ Ù‚Ù„Ø¨ÙƒØŸ</h2>
    <div id="moodGrid" style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
        </div>
    <button class="btn-main" style="margin-top:20px" onclick="goHome()">ğŸ  Ø§Ù„Ø¹ÙˆØ¯Ø©</button>
</div>

<div id="khalwaOverlay">
    <div id="khalwaText" style="font-size:2.5em; color:var(--accent); transition: 2s; padding:20px;"></div>
    <button class="btn-main" style="position:fixed; bottom:50px; left:50%; transform:translateX(-50%)" onclick="stopKhalwa()">Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ø®Ù„ÙˆØ©</button>
</div>

<script>
    const tg = window.Telegram.WebApp;
    const OWNER_ID = 8421694319; 
    let activeName = "";

    // Firebase Configuration
    const firebaseConfig = { databaseURL: "https://allahfirst-b9c52-default-rtdb.firebaseio.com/" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø§Ù„Ùƒ
    if(tg.initDataUnsafe.user?.id === OWNER_ID) {
        document.getElementById('adminPanel').style.display = 'block';
        document.getElementById('resetBtn').style.display = 'block';
    }

    // Ø§Ù„ØªÙ†Ù‚Ù„
    function openSection(id) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active-page'));
        document.getElementById(id).classList.add('active-page');
        if(id === 'namesPage') loadNames();
        if(id === 'thoughtsPage') loadThoughts();
        if(id === 'moodPage') loadMoods();
        window.scrollTo(0,0);
    }

    function goHome() { openSection('homePage'); }

    // ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø£ÙˆØ¶Ø§Ø¹
    let currentMode = 0; // 0: Light, 1: Dark, 2: Ramadan
    function toggleVisualMode() {
        const b = document.body;
        b.classList.remove('dark-mode', 'ramadan-mode');
        currentMode = (currentMode + 1) % 3;
        if(currentMode === 1) b.classList.add('dark-mode');
        if(currentMode === 2) b.classList.add('ramadan-mode');
    }

    // Ø§Ù„Ø³Ø¨Ø­Ø© Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ©
    function incrementGlobalTasbih() { db.ref('g_tasbih').transaction(c => (c || 0) + 1); }
    db.ref('g_tasbih').on('value', s => { document.getElementById('globalCount').innerText = s.val() || 0; });
    function resetGlobal() { if(confirm("ØªØµÙÙŠØ± Ø§Ù„Ø³Ø¨Ø­Ø©ØŸ")) db.ref('g_tasbih').set(0); }

    // Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Ø§Ù„Ù…Ø§Ù„ÙƒØ©)
    function uploadData() {
        const type = document.getElementById('dataType').value;
        const title = document.getElementById('dataTitle').value;
        const content = document.getElementById('dataContent').value;
        if(!title || !content) return;
        db.ref(type + '/' + title).set({ content: content });
        alert("ØªÙ… Ø§Ù„Ù†Ø´Ø± Ø¨Ù†Ø¬Ø§Ø­");
        document.getElementById('dataTitle').value = "";
        document.getElementById('dataContent').value = "";
    }

    function deleteItem(path) {
        if(confirm("Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù†ØµØ± Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ØŸ")) db.ref(path).remove();
    }

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡
    function loadNames() {
        db.ref('names').on('value', s => {
            const list = document.getElementById('namesList');
            list.innerHTML = "";
            const data = s.val();
            for(let key in data) {
                list.innerHTML += `
                <div class="btn-main" onclick="viewName('${key}')">
                    <span>${key}</span>
                    ${tg.initDataUnsafe.user?.id === OWNER_ID ? `<span class="delete-btn" onclick="event.stopPropagation(); deleteItem('names/${key}')">ğŸ—‘ï¸</span>` : '<span>âœ¨</span>'}
                </div>`;
            }
        });
    }

    function viewName(name) {
        activeName = name;
        db.ref('names/' + name).once('value', s => {
            const val = s.val();
            document.getElementById('currentName').innerText = name;
            const parts = val.content.split('|');
            document.getElementById('currentContent').innerText = parts[0];
            
            let tasks = "<h3>ğŸ“ Ù†Ù‚Ø§Ø· Ø¹Ù…Ù„ÙŠØ©:</h3>";
            for(let i=1; i<parts.length; i++) tasks += `<p>â€¢ ${parts[i]}</p>`;
            document.getElementById('currentTasks').innerHTML = tasks;
            
            openSection('nameDetails');
            loadStories(name);
        });
    }

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®ÙˆØ§Ø·Ø±
    function loadThoughts() {
        db.ref('thoughts').on('value', s => {
            const list = document.getElementById('thoughtsList');
            list.innerHTML = "";
            const data = s.val();
            for(let key in data) {
                list.innerHTML += `
                <div style="background:var(--card); padding:20px; border-radius:15px; margin-bottom:15px; box-shadow:var(--shadow)">
                    <strong>${key}</strong>
                    <p>${data[key].content}</p>
                    ${tg.initDataUnsafe.user?.id === OWNER_ID ? `<span class="delete-btn" onclick="deleteItem('thoughts/${key}')">ğŸ—‘ï¸ Ø­Ø°Ù</span>` : ''}
                </div>`;
            }
        });
    }

    // ÙƒÙŠÙ Ø­Ø§Ù„ Ù‚Ù„Ø¨Ùƒ
    const moods = ["Ù…ÙƒØ³ÙˆØ±", "Ø³Ø¹ÙŠØ¯", "Ù‚Ù„Ù‚", "Ù…Ø´ØªØ§Ù‚", "ØªØ§Ø¦Ù‡", "Ø®Ø§Ø¦Ù", "Ù…Ø·Ù…Ø¦Ù†", "ÙˆØ­ÙŠØ¯", "Ù…Ù‚Ø¨Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ù„Ù‡", "Ù…ØªØ¹Ø¨", "Ø±Ø§Ø¶Ù", "Ù…Ø°Ù†Ø¨"];
    function loadMoods() {
        const grid = document.getElementById('moodGrid');
        grid.innerHTML = "";
        moods.forEach(m => {
            grid.innerHTML += `<button class="btn-main" style="justify-content:center" onclick="showMoodMsg('${m}')">${m}</button>`;
        });
    }
    function showMoodMsg(m) {
        alert("Ø±Ø³Ø§Ù„Ø© Ù„Ù‚Ù„Ø¨Ùƒ Ø§Ù„Ù€ " + m + ":\nØ§Ø³ØªØ¹Ù† Ø¨Ø§Ù„Ù„Ù‡ ÙˆÙ„Ø§ ØªØ¹Ø¬Ø²ØŒ ÙÙ…Ø§ Ø¬Ø¹Ù„ Ø§Ù„Ù„Ù‡ Ù‡Ø°Ø§ Ø§Ù„Ø´Ø¹ÙˆØ± ÙÙŠ Ù‚Ù„Ø¨Ùƒ Ø¥Ù„Ø§ Ù„ÙŠÙ‚Ø±Ø¨Ùƒ Ù…Ù†Ù‡.");
    }

    // Ø§Ù„Ø®Ù„ÙˆØ©
    let khalwaTimer;
    const ayahs = ["ÙÙØ¥ÙÙ†Ù‘ÙÙŠ Ù‚ÙØ±ÙÙŠØ¨ÙŒ", "Ø£ÙÙ„ÙØ§ Ø¨ÙØ°ÙÙƒÙ’Ø±Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù ØªÙØ·Ù’Ù…ÙØ¦ÙÙ†Ù‘Ù Ø§Ù„Ù’Ù‚ÙÙ„ÙÙˆØ¨Ù", "ÙˆÙÙ‡ÙÙˆÙ Ù…ÙØ¹ÙÙƒÙÙ…Ù’ Ø£ÙÙŠÙ’Ù†Ù Ù…ÙØ§ ÙƒÙÙ†Ù’ØªÙÙ…Ù’", "Ù„ÙØ§ ØªÙØ­Ù’Ø²ÙÙ†Ù’ Ø¥ÙÙ†Ù‘Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù Ù…ÙØ¹ÙÙ†ÙØ§", "ÙˆÙÙ†ÙØ­Ù’Ù†Ù Ø£ÙÙ‚Ù’Ø±ÙØ¨Ù Ø¥ÙÙ„ÙÙŠÙ’Ù‡Ù Ù…ÙÙ†Ù’ Ø­ÙØ¨Ù’Ù„Ù Ø§Ù„Ù’ÙˆÙØ±ÙÙŠØ¯Ù"];
    function startKhalwa() {
        document.getElementById('khalwaOverlay').style.display = 'flex';
        let i = 0;
        const textEl = document.getElementById('khalwaText');
        textEl.innerText = "Ø£ØºÙ…Ø¶ Ø¹ÙŠÙ†ÙŠÙƒ ÙˆØªÙ†ÙØ³..";
        khalwaTimer = setInterval(() => {
            textEl.style.opacity = 0;
            setTimeout(() => {
                textEl.innerText = ayahs[i % ayahs.length];
                textEl.style.opacity = 1;
                i++;
            }, 1000);
        }, 5000);
    }
    function stopKhalwa() { clearInterval(khalwaTimer); document.getElementById('khalwaOverlay').style.display = 'none'; }

    // Ø§Ù„Ù…Ù†Ø§Ø¬Ø§Ø©
    function sendToHeaven() {
        if(document.getElementById('munajatText').value.trim() === "") return;
        alert("ØµØ¹Ø¯Øª Ù…Ù†Ø§Ø¬Ø§ØªÙƒ Ø¥Ù„Ù‰ Ø§Ù„Ù„Ù‡.. Ø·ÙØ¨ Ù†ÙØ³Ø§Ù‹.");
        document.getElementById('munajatText').value = "";
        goHome();
    }

    // Ø§Ù„Ù…ÙˆØ§Ù‚Ù (Firebase)
    function loadStories(name) {
        db.ref('stories/' + name).on('value', s => {
            const box = document.getElementById('storiesBox');
            box.innerHTML = "";
            const data = s.val();
            for(let id in data) {
                box.innerHTML += `<div style="border-bottom:1px solid rgba(179,135,40,0.2); padding:8px; font-size:0.9em;">${data[id]}</div>`;
            }
        });
    }
    function saveStory() {
        const text = document.getElementById('newStory').value;
        if(!text) return;
        db.ref('stories/' + activeName).push(text);
        document.getElementById('newStory').value = "";
    }

    // Ø³Ø¨Ø­Ø© ÙˆØ±Ø¯ Ø§Ù„Ø§Ø³Ù… (Ù…Ø­Ù„ÙŠ)
    let localCount = 0;
    function localTasbih() { localCount++; document.getElementById('localCount').innerText = localCount; }

    tg.expand();
</script>
</body>
</html>
