<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ù„Ù‡ Ø£ÙˆÙ„Ø§Ù‹</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap');
        
        :root {
            --gold: linear-gradient(45deg, #bf953f, #fcf6ba, #b38728, #fbf5b7, #aa771c);
            --silver: linear-gradient(45deg, #bfc0c0, #ffffff, #8d99ae, #ffffff, #bfc0c0);
            --dark-gold: #b38728;
            --creamy: #fdfaf1;
            --brown: #4a342e;
            --bg: var(--creamy);
            --txt: var(--brown);
            --card: #ffffff;
            --btn-txt: #222;
        }

        /* ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø§Ù„ÙƒØ©: Ø£Ø³ÙˆØ¯ ÙˆØ°Ù‡Ø¨ÙŠ ÙØ®Ù… */
        body.dark-mode {
            --bg: #000000;
            --txt: #fcf6ba;
            --card: #111111;
            --dark-gold: #bf953f;
            --btn-txt: #222;
        }

        /* Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø±Ù…Ø¶Ø§Ù†ÙŠ: Ø£Ø²Ø±Ù‚ Ù…Ù„ÙƒÙŠ ÙˆÙØ¶ÙŠ */
        body.ramadan-mode {
            --bg: #050a18;
            --txt: #ffffff;
            --card: #0d1b3e;
            --dark-gold: #bfc0c0; /* ÙØ¶ÙŠ */
            --gold: var(--silver); /* Ù‚Ù„Ø¨ Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ù„Ù„ÙØ¶ÙŠ */
            --btn-txt: #050a18;
        }

        body { 
            font-family: 'Amiri', serif; background-color: var(--bg); 
            color: var(--txt); margin: 0; padding: 15px; transition: 0.5s;
            text-align: center;
        }

        /* Ø¥Ø·Ø§Ø± Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù‡Ø¬Ø±ÙŠ */
        .hijri-badge {
            font-size: 0.9em; color: var(--dark-gold); border: 2px solid var(--dark-gold);
            padding: 5px 20px; border-radius: 20px; display: inline-block; margin-bottom: 15px;
            background: var(--card); font-weight: bold;
        }

        /* Ø´Ø¹Ø§Ø± Ø§Ù„Ù„Ù‡ Ø£ÙˆÙ„Ø§Ù‹ - Ø¨Ø§Ø±Ø² Ø¬Ø¯Ø§Ù‹ */
        .logo-container { margin-bottom: 35px; }
        .logo { 
            font-size: 5em; font-weight: 700; background: var(--gold);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            filter: drop-shadow(0px 6px 5px rgba(0,0,0,0.5)); margin: 0; line-height: 1;
        }
        .subtitle { 
            font-size: 1.2em; color: var(--dark-gold); margin-top: 15px; 
            max-width: 90%; margin-left: auto; margin-right: auto; line-height: 1.5;
            font-weight: bold;
        }

        /* Ù„ÙˆØ­Ø© Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù…Ø§Ù„ÙƒØ© - Ù…Ø®ÙÙŠØ© ÙˆØ³Ø±ÙŠØ© */
        #ownerMonitor {
            display: none; background: #000; color: #00ff00; font-family: monospace;
            padding: 15px; border-radius: 15px; margin-top: 30px; border: 1px solid #00ff00;
            text-align: left; direction: ltr; font-size: 0.8em; box-shadow: 0 0 15px #00ff0044;
        }

        .footer-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 20px; }

        .action-card {
            background: var(--card); border: 2px solid var(--dark-gold);
            padding: 20px; border-radius: 25px; text-align: center;
            box-shadow: 0 8px 20px rgba(0,0,0,0.15); transition: 0.3s;
        }

        .sebha-btn {
            width: 70px; height: 70px; border-radius: 50%; border: 4px solid var(--dark-gold);
            margin: 12px auto; display: flex; align-items: center; justify-content: center;
            font-weight: bold; font-size: 1.5em; cursor: pointer; background: var(--bg);
            box-shadow: inset 0 0 10px rgba(0,0,0,0.1);
        }

        .name-btn { 
            background: var(--gold); color: var(--btn-txt); border: none; padding: 20px; 
            border-radius: 25px; font-weight: bold; width: 100%; margin-bottom: 15px;
            font-size: 1.4em; cursor: pointer; box-shadow: 0 6px 20px rgba(184, 134, 11, 0.4);
        }

        .controls { position: fixed; top: 15px; left: 15px; z-index: 100; display: flex; gap: 10px; }
        .mode-btn { background: var(--card); border: 2px solid var(--dark-gold); padding: 10px; border-radius: 50%; cursor: pointer; font-size: 1.2em; }

        .section { display: none; animation: fadeIn 0.5s ease; }
        .active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body id="mainBody">

<div class="controls">
    <button class="mode-btn" onclick="toggleMode('dark')">ğŸ•¶ï¸</button>
    <button class="mode-btn" onclick="toggleMode('ramadan')">ğŸŒ™</button>
</div>

<div style="max-width: 500px; margin: auto;">
    
    <div id="home" class="section active">
        <div class="hijri-badge" id="hijriDate">...</div>
        
        <div class="logo-container">
            <h1 class="logo">Ø§Ù„Ù„Ù‡ Ø£ÙˆÙ„Ø§Ù‹</h1>
            <p class="subtitle">Ø³ÙŠØ±ÙˆØ§ Ø¥Ù„Ù‰ Ø§Ù„Ù„Ù‡ Ø¹Ø±Ø¬Ù‰ Ùˆ Ù…ÙƒØ§Ø³ÙŠØ± ÙØ¥Ù† Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„ØµØ­Ø© Ø¨Ø·Ø§Ù„Ø©</p>
        </div>

        <button class="name-btn" onclick="showSection('namesList')">ğŸ“– Ø±Ø­Ù„Ø© Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù„Ù‡</button>
        
        <div class="action-card" style="margin-bottom: 15px; background: var(--gold); color: var(--btn-txt);">
            <small style="font-weight: bold;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ ØªØ³Ø¨ÙŠØ­Ø§Øª Ø§Ù„Ø£Ù…Ø©</small>
            <div id="globalCount" style="font-size: 2.8em; font-weight: bold; letter-spacing: 2px;">0</div>
            <small style="font-weight: bold;">ÙˆÙØªÙØ¹ÙØ§ÙˆÙÙ†ÙÙˆØ§ Ø¹ÙÙ„ÙÙ‰ Ø§Ù„Ù’Ø¨ÙØ±Ù‘Ù</small>
        </div>

        <div class="footer-grid">
            <div class="action-card" onclick="showSection('publicStories')" style="cursor: pointer;">
                <div style="font-size: 2.5em;">ğŸ’¬</div>
                <strong style="font-size: 1.2em;">Ù…ÙˆØ§Ù‚ÙÙƒÙ…</strong>
                <div style="font-size: 0.8em; margin-top: 5px; opacity: 0.8;">Ù‚ØµØµ Ø§Ù„ÙŠÙ‚ÙŠÙ†</div>
            </div>

            <div class="action-card" onclick="countSalah()" style="cursor: pointer;">
                <strong style="font-size: 1.1em;">Ø§Ù„ØµÙ„Ø§Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¨ÙŠ</strong>
                <div class="sebha-btn" id="salahCountDisplay">0</div>
                <div style="font-size: 0.9em; font-weight: bold;">ï·º</div>
            </div>
        </div>

        <div id="ownerMonitor">
            <div style="border-bottom: 1px solid #00ff00; padding-bottom: 5px; margin-bottom: 10px;">ğŸ›¡ï¸ Ù„ÙˆØ­Ø© Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù…Ø§Ù„ÙƒØ©</div>
            <div>> Ø§Ù„Ø²ÙˆØ§Ø± Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: <span id="vCount">0</span></div>
            <div>> Ø§Ù„Ø¬Ù„Ø³Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø©: <span id="sCount">1</span></div>
            <div>> Ø¢Ø®Ø± Ø¹Ù…Ù„ÙŠØ©: <span id="lastOp">Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„...</span></div>
        </div>
    </div>

    <div id="namesList" class="section">
        <h2 style="color:var(--dark-gold); font-size: 2em;">Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø­Ø³Ù†Ù‰</h2>
        <div id="mainGrid"></div>
        <button class="name-btn" style="background:#333; color:white; margin-top:30px;" onclick="showSection('home')">Ø±Ø¬ÙˆØ¹ Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
    </div>

    <div id="publicStories" class="section">
        <h2 style="color:var(--dark-gold); font-size: 2em;">Ù…ÙˆØ§Ù‚ÙÙƒÙ… Ù…Ø¹ Ø§Ù„Ù„Ù‡</h2>
        <div id="allPublicStories"></div>
        <button class="name-btn" style="background:#333; color:white;" onclick="showSection('home')">Ø±Ø¬ÙˆØ¹</button>
    </div>

</div>

<script>
    const tg = window.Telegram.WebApp;
    const OWNER_ID = 8421694319; // Ø±Ù‚Ù…Ùƒ Ø§Ù„Ø®Ø§Øµ

    function logAction(msg) {
        document.getElementById('lastOp').innerText = msg;
    }

    function toggleMode(mode) {
        if(mode === 'dark') {
            document.body.classList.remove('ramadan-mode');
            document.body.classList.toggle('dark-mode');
            logAction("ØªØ¨Ø¯ÙŠÙ„ Ù„Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ");
        } else {
            document.body.classList.remove('dark-mode');
            document.body.classList.toggle('ramadan-mode');
            logAction("ØªØ¨Ø¯ÙŠÙ„ Ù„Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø±Ù…Ø¶Ø§Ù†ÙŠ");
        }
    }

    function updateHijri() {
        const date = new Date();
        const options = { day: 'numeric', month: 'long', year: 'numeric' };
        document.getElementById('hijriDate').innerText = new Intl.DateTimeFormat('ar-SA-u-ca-islamic-umalqura', options).format(date);
    }

    function countSalah() {
        let c = Number(localStorage.getItem('salah_count') || 0) + 1;
        localStorage.setItem('salah_count', c);
        document.getElementById('salahCountDisplay').innerText = c;
        logAction("ØµÙ„Ø§Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¨ÙŠ +1");
        if (navigator.vibrate) navigator.vibrate(40);
    }

    function showSection(id) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        logAction("ÙØªØ­ Ù‚Ø³Ù…: " + id);
        if(id === 'namesList') renderNames();
        if(id === 'publicStories') renderPublicStories();
    }

    function renderNames() {
        const grid = document.getElementById('mainGrid'); grid.innerHTML = "";
        const data = JSON.parse(localStorage.getItem('app_names_data') || "{}");
        Object.keys(data).forEach(name => {
            const btn = document.createElement('button');
            btn.className = "name-btn"; btn.style.fontSize = "1.1em";
            btn.innerText = name;
            grid.appendChild(btn);
        });
    }

    function renderPublicStories() {
        const div = document.getElementById('allPublicStories');
        let p = JSON.parse(localStorage.getItem('public_stories_all') || "[]");
        div.innerHTML = p.map(s => `<div class="action-card" style="margin-bottom:15px; text-align:right;"><strong>${s.name}</strong><p>${s.text}</p></div>`).join('');
    }

    // ØªØªØ¨Ø¹ Ø§Ù„Ø²ÙˆØ§Ø± (Ù…Ø­Ø§ÙƒØ§Ø©)
    function trackVisitors() {
        let v = Number(localStorage.getItem('owner_v_count') || 0);
        if(!sessionStorage.getItem('counted')) {
            v++;
            localStorage.setItem('owner_v_count', v);
            sessionStorage.setItem('counted', 'true');
        }
        document.getElementById('vCount').innerText = v;
    }

    // ÙØ­Øµ Ø§Ù„Ù‡ÙˆÙŠØ© Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù„ÙˆØ­Ø©
    if (tg.initDataUnsafe.user && tg.initDataUnsafe.user.id === OWNER_ID) {
        document.getElementById('ownerMonitor').style.display = 'block';
    }

    // Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
    updateHijri();
    trackVisitors();
    document.getElementById('salahCountDisplay').innerText = localStorage.getItem('salah_count') || 0;
    document.getElementById('globalCount').innerText = (localStorage.getItem('global_tasbih_count') || 0);

</script>
</body>
</html>
